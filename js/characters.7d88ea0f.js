(self["webpackChunkjdrave_app"]=self["webpackChunkjdrave_app"]||[]).push([[489],{3773:function(e,a,n){"use strict";n.d(a,{q:function(){return t}});var i=n(6252);const t=e=>(0,i.Fl)((()=>{const a=e.value.trim().split(/\s+/),n=a.pop();return`${a.join(" ")} <span>${n}</span>`}))},2495:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return E}});var i=n(6252);const t={class:"flex justify-between align-middle mb-8"},r=["innerHTML"],d=(0,i.Uk)("Supprimer"),l={key:0},u={key:1,class:"border rounded-xl p-6 grid grid-cols-3 gap-6"},c={class:"col-span-2 grid grid-cols-2 gap-x-6 place-content-start"},o=(0,i.Uk)(" Valider "),s={class:"text-center"},m=["src"],v=(0,i.Uk)(" Changer la photo ");function f(e,a,n,f,k,p){const h=(0,i.up)("BaseButton"),b=(0,i.up)("BaseInput"),N=(0,i.up)("BaseTextarea");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("header",t,[(0,i._)("h1",{class:"page-title",innerHTML:e.title},null,8,r),(0,i.Wm)(h,{class:"warning",onClick:e.deleteCharacter},{default:(0,i.w5)((()=>[d])),_:1},8,["onClick"])]),e.loading?((0,i.wg)(),(0,i.iD)("p",l,"Character is loading")):((0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("div",c,[(0,i.Wm)(b,{label:"Nom",modelValue:e.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.name=a)},null,8,["modelValue"]),(0,i.Wm)(b,{class:"row-start-2",label:"PV actuel",modelValue:e.currentHp,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentHp=a),max:e.maxHp,type:"number"},null,8,["modelValue","max"]),(0,i.Wm)(b,{class:"row-start-2",label:"PV max",modelValue:e.maxHp,"onUpdate:modelValue":a[2]||(a[2]=a=>e.maxHp=a),type:"number"},null,8,["modelValue"]),(0,i.Wm)(N,{class:"col-span-full",label:"Features",modelValue:e.features,"onUpdate:modelValue":a[3]||(a[3]=a=>e.features=a)},null,8,["modelValue"]),(0,i._)("div",null,[(0,i.Wm)(h,{class:"primary",onClick:e.updateCharacter,"is-loading":e.isUpdating},{default:(0,i.w5)((()=>[o])),_:1},8,["onClick","is-loading"])])]),(0,i._)("div",s,[(0,i._)("img",{class:"rounded w-96 h-96 object-cover mb-6",src:e.picture},null,8,m),(0,i.Wm)(h,{class:"primary",onClick:e.triggerFileInputFocus},{default:(0,i.w5)((()=>[v])),_:1},8,["onClick"]),(0,i._)("input",{ref:"pictureInputRef",class:"hidden",type:"file",onChange:a[4]||(a[4]=(...a)=>e.handlePictureUpload&&e.handlePictureUpload(...a))},null,544)])]))],64)}var k=n(2262),p=n(7102),h=n(5245),b=n.n(h),N=n(7876),g=n.n(N),y=n(5131),S=n.n(y),_=n(4714),w=n.n(_),V=n(2119),D=n(3773);const F=async e=>{const a=new FormData;a.append("file",e),a.append("upload_preset","oadh3tc2"),a.append("folder","characters");const n=await fetch("https://api.cloudinary.com/v1_1/jdrave/image/upload",{method:"POST",body:a}),i=await(n?.json());return{url:i.url}};var I=(0,i.aZ)({name:"CharacterPage",props:{characterId:{type:String,required:!0}},setup(e){const a=(0,k.iH)(""),n=(0,k.iH)(""),t=(0,k.iH)(0),r=(0,k.iH)(0),d=(0,k.iH)(""),l=(0,k.iH)(null),{result:u,loading:c}=(0,p.aM)(b(),(()=>({characterId:e.characterId}))),o=(0,p.pc)(u,null,(e=>e.character));let s=(0,i.Fl)((()=>""));(0,i.m0)((()=>{o.value&&(a.value=o.value.name||"",n.value=JSON.stringify(o.value.features),t.value=o.value.maxHp,r.value=o.value.currentHp,d.value=o.value.picture),s=(0,D.q)(a)}));const{mutate:m,loading:v,onDone:f}=(0,p.Db)(g(),(()=>({variables:{characterId:e.characterId,name:a.value,features:JSON.parse(n.value),currentHp:r.value,maxHp:t.value}})));f((()=>{console.log("Done!")}));const{mutate:h,onDone:N}=(0,p.Db)(w(),(()=>({variables:{characterId:e.characterId}}))),y=(0,V.tv)();N((({data:e})=>{y.replace({name:"game",params:{gameId:e.deleteCharacter.gameId}})}));const{mutate:_}=(0,p.Db)(S()),I=async a=>{const n=a.target.files?.[0];if(n){const{url:a}=await F(n);await _({characterId:e.characterId,pictureUrl:a})}},x=()=>{l.value?.click()};return{loading:c,character:o,name:a,features:n,currentHp:r,maxHp:t,updateCharacter:m,deleteCharacter:h,title:s,isUpdating:v,picture:d,handlePictureUpload:I,triggerFileInputFocus:x,pictureInputRef:l}}}),x=n(8118);const H=(0,x.Z)(I,[["render",f]]);var E=H},7876:function(e){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CharacterMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"features"}},type:{kind:"NamedType",name:{kind:"Name",value:"jsonb"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxHp"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"currentHp"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"update_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pk_columns"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}]}},{kind:"Argument",name:{kind:"Name",value:"_set"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"ObjectField",name:{kind:"Name",value:"features"},value:{kind:"Variable",name:{kind:"Name",value:"features"}}},{kind:"ObjectField",name:{kind:"Name",value:"max_hp"},value:{kind:"Variable",name:{kind:"Name",value:"maxHp"}}},{kind:"ObjectField",name:{kind:"Name",value:"current_hp"},value:{kind:"Variable",name:{kind:"Name",value:"currentHp"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"features"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"maxHp"},name:{kind:"Name",value:"max_hp"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"currentHp"},name:{kind:"Name",value:"current_hp"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:333}};a.loc.source={body:"mutation CharacterMutation($characterId: uuid!, $name: String, $features: jsonb, $maxHp: Int, $currentHp: Int) {\n  update_characters_by_pk(pk_columns: {id: $characterId}, _set: {name: $name, features: $features, max_hp: $maxHp, current_hp: $currentHp}) {\n    id\n    name\n    features\n    maxHp: max_hp\n    currentHp: current_hp\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,a){if("FragmentSpread"===e.kind)a.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&a.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,a)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,a)})),e.definitions&&e.definitions.forEach((function(e){n(e,a)}))}var i={};function t(e,a){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==a)return i}}function r(e,a){var n={kind:e.kind,definitions:[t(e,a)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[a]||new Set,d=new Set,l=new Set;r.forEach((function(e){l.add(e)}));while(l.size>0){var u=l;l=new Set,u.forEach((function(e){if(!d.has(e)){d.add(e);var a=i[e]||new Set;a.forEach((function(e){l.add(e)}))}}))}return d.forEach((function(a){var i=t(e,a);i&&n.definitions.push(i)})),n}(function(){a.definitions.forEach((function(e){if(e.name){var a=new Set;n(e,a),i[e.name.value]=a}}))})(),e.exports=a,e.exports.CharacterMutation=r(a,"CharacterMutation")},5245:function(e){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CharacterQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"character"},name:{kind:"Name",value:"characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"features"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"maxHp"},name:{kind:"Name",value:"max_hp"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"currentHp"},name:{kind:"Name",value:"current_hp"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"picture"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:185}};a.loc.source={body:"query CharacterQuery($characterId: uuid!) {\n  character: characters_by_pk(id: $characterId) {\n    id\n    name\n    features\n    maxHp: max_hp\n    currentHp: current_hp\n    picture\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,a){if("FragmentSpread"===e.kind)a.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&a.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,a)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,a)})),e.definitions&&e.definitions.forEach((function(e){n(e,a)}))}var i={};function t(e,a){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==a)return i}}function r(e,a){var n={kind:e.kind,definitions:[t(e,a)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[a]||new Set,d=new Set,l=new Set;r.forEach((function(e){l.add(e)}));while(l.size>0){var u=l;l=new Set,u.forEach((function(e){if(!d.has(e)){d.add(e);var a=i[e]||new Set;a.forEach((function(e){l.add(e)}))}}))}return d.forEach((function(a){var i=t(e,a);i&&n.definitions.push(i)})),n}(function(){a.definitions.forEach((function(e){if(e.name){var a=new Set;n(e,a),i[e.name.value]=a}}))})(),e.exports=a,e.exports.CharacterQuery=r(a,"CharacterQuery")},5131:function(e){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CharacterPictureMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pictureUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"update_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pk_columns"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}]}},{kind:"Argument",name:{kind:"Name",value:"_set"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"picture"},value:{kind:"Variable",name:{kind:"Name",value:"pictureUrl"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"picture"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:193}};a.loc.source={body:"mutation CharacterPictureMutation($characterId: uuid!, $pictureUrl: String!) {\n  update_characters_by_pk(pk_columns: {id: $characterId}, _set: {picture: $pictureUrl}) {\n    id\n    picture\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,a){if("FragmentSpread"===e.kind)a.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&a.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,a)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,a)})),e.definitions&&e.definitions.forEach((function(e){n(e,a)}))}var i={};function t(e,a){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==a)return i}}function r(e,a){var n={kind:e.kind,definitions:[t(e,a)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[a]||new Set,d=new Set,l=new Set;r.forEach((function(e){l.add(e)}));while(l.size>0){var u=l;l=new Set,u.forEach((function(e){if(!d.has(e)){d.add(e);var a=i[e]||new Set;a.forEach((function(e){l.add(e)}))}}))}return d.forEach((function(a){var i=t(e,a);i&&n.definitions.push(i)})),n}(function(){a.definitions.forEach((function(e){if(e.name){var a=new Set;n(e,a),i[e.name.value]=a}}))})(),e.exports=a,e.exports.CharacterPictureMutation=r(a,"CharacterPictureMutation")},4714:function(e){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MyMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"deleteCharacter"},name:{kind:"Name",value:"delete_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"gameId"},name:{kind:"Name",value:"game_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:139}};a.loc.source={body:"mutation MyMutation($characterId: uuid!) {\n  deleteCharacter: delete_characters_by_pk(id: $characterId) {\n    gameId: game_id,\n    id\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,a){if("FragmentSpread"===e.kind)a.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&a.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,a)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,a)})),e.definitions&&e.definitions.forEach((function(e){n(e,a)}))}var i={};function t(e,a){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==a)return i}}function r(e,a){var n={kind:e.kind,definitions:[t(e,a)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[a]||new Set,d=new Set,l=new Set;r.forEach((function(e){l.add(e)}));while(l.size>0){var u=l;l=new Set,u.forEach((function(e){if(!d.has(e)){d.add(e);var a=i[e]||new Set;a.forEach((function(e){l.add(e)}))}}))}return d.forEach((function(a){var i=t(e,a);i&&n.definitions.push(i)})),n}(function(){a.definitions.forEach((function(e){if(e.name){var a=new Set;n(e,a),i[e.name.value]=a}}))})(),e.exports=a,e.exports.MyMutation=r(a,"MyMutation")}}]);
//# sourceMappingURL=characters.7d88ea0f.js.map