(self["webpackChunkjdrave_app"]=self["webpackChunkjdrave_app"]||[]).push([[489],{3773:function(e,n,a){"use strict";a.d(n,{q:function(){return t}});a(4916),a(3123),a(3210),a(2222),a(9600);var i=a(6252),t=function(e){return(0,i.Fl)((function(){var n=e.value.trim().split(/\s+/),a=n.pop();return"".concat(n.join(" ")," <span>").concat(a,"</span>")}))}},2495:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return C}});a(8309);var i=a(6252),t={class:"flex justify-between align-middle mb-8"},r=["innerHTML"],u=(0,i.Uk)("Supprimer"),d={key:0},l={key:1,class:"border rounded-xl p-6 grid grid-cols-3 gap-6"},c={class:"col-span-2 grid grid-cols-2 gap-x-6 place-content-start"},o=(0,i.Uk)(" Valider "),s={class:"text-center"},m=["src"],f=(0,i.Uk)(" Changer la photo ");function v(e,n,a,v,p,k){var h=(0,i.up)("BaseButton"),b=(0,i.up)("BaseInput"),N=(0,i.up)("BaseTextarea");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("header",t,[(0,i._)("h1",{class:"page-title",innerHTML:e.title},null,8,r),(0,i.Wm)(h,{class:"warning",onClick:e.deleteCharacter},{default:(0,i.w5)((function(){return[u]})),_:1},8,["onClick"])]),e.loading?((0,i.wg)(),(0,i.iD)("p",d,"Character is loading")):((0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",c,[(0,i.Wm)(b,{label:"Nom",modelValue:e.name,"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.name=n})},null,8,["modelValue"]),(0,i.Wm)(b,{class:"row-start-2",label:"PV actuel",modelValue:e.currentHp,"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.currentHp=n}),max:e.maxHp,type:"number"},null,8,["modelValue","max"]),(0,i.Wm)(b,{class:"row-start-2",label:"PV max",modelValue:e.maxHp,"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.maxHp=n}),type:"number"},null,8,["modelValue"]),(0,i.Wm)(N,{class:"col-span-full",label:"Features",modelValue:e.features,"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.features=n})},null,8,["modelValue"]),(0,i._)("div",null,[(0,i.Wm)(h,{class:"primary",onClick:e.updateCharacter,"is-loading":e.isUpdating},{default:(0,i.w5)((function(){return[o]})),_:1},8,["onClick","is-loading"])])]),(0,i._)("div",s,[(0,i._)("img",{class:"rounded w-96 h-96 object-cover mb-6",src:e.picture},null,8,m),(0,i.Wm)(h,{class:"primary",onClick:e.triggerFileInputFocus},{default:(0,i.w5)((function(){return[f]})),_:1},8,["onClick"]),(0,i._)("input",{ref:"pictureInputRef",class:"hidden",type:"file",onChange:n[4]||(n[4]=function(){return e.handlePictureUpload&&e.handlePictureUpload.apply(e,arguments)})},null,544)])]))],64)}var p=a(8534),k=(a(5666),a(8862),a(4916),a(5306),a(2262)),h=a(7102),b=a(5245),N=a.n(b),g=a(7876),y=a.n(g),S=a(5131),_=a.n(S),w=a(4714),V=a.n(w),x=a(2119),D=a(3773),F=(a(1539),function(){var e=(0,p.Z)(regeneratorRuntime.mark((function e(n){var a,i,t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("file",n),a.append("upload_preset","oadh3tc2"),a.append("folder","characters"),e.next=6,fetch("https://api.cloudinary.com/v1_1/jdrave/image/upload",{method:"POST",body:a});case 6:return i=e.sent,e.next=9,null===i||void 0===i?void 0:i.json();case 9:return t=e.sent,e.abrupt("return",{url:t.url});case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),I=(0,i.aZ)({name:"CharacterPage",props:{characterId:{type:String,required:!0}},setup:function(e){var n=(0,k.iH)(""),a=(0,k.iH)(""),t=(0,k.iH)(0),r=(0,k.iH)(0),u=(0,k.iH)(""),d=(0,k.iH)(null),l=(0,h.aM)(N(),(function(){return{characterId:e.characterId}})),c=l.result,o=l.loading,s=(0,h.pc)(c,null,(function(e){return e.character})),m=(0,i.Fl)((function(){return""}));(0,i.m0)((function(){s.value&&(n.value=s.value.name||"",a.value=JSON.stringify(s.value.features),t.value=s.value.maxHp,r.value=s.value.currentHp,u.value=s.value.picture),m=(0,D.q)(n)}));var f=(0,h.Db)(y(),(function(){return{variables:{characterId:e.characterId,name:n.value,features:JSON.parse(a.value),currentHp:r.value,maxHp:t.value}}})),v=f.mutate,b=f.loading,g=f.onDone;g((function(){console.log("Done!")}));var S=(0,h.Db)(V(),(function(){return{variables:{characterId:e.characterId}}})),w=S.mutate,I=S.onDone,H=(0,x.tv)();I((function(e){var n=e.data;H.replace({name:"game",params:{gameId:n.deleteCharacter.gameId}})}));var E=(0,h.Db)(_()),C=E.mutate,O=function(){var n=(0,p.Z)(regeneratorRuntime.mark((function n(a){var i,t,r,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=null===(i=a.target.files)||void 0===i?void 0:i[0],!t){n.next=8;break}return n.next=4,F(t);case 4:return r=n.sent,u=r.url,n.next=8,C({characterId:e.characterId,pictureUrl:u});case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),j=function(){var e;null===(e=d.value)||void 0===e||e.click()};return{loading:o,character:s,name:n,features:a,currentHp:r,maxHp:t,updateCharacter:v,deleteCharacter:w,title:m,isUpdating:b,picture:u,handlePictureUpload:O,triggerFileInputFocus:j,pictureInputRef:d}}}),H=a(8118);const E=(0,H.Z)(I,[["render",v]]);var C=E},6091:function(e,n,a){var i=a(6530).PROPER,t=a(7293),r=a(1361),u="​᠎";e.exports=function(e){return t((function(){return!!r[e]()||u[e]()!==u||i&&r[e].name!==e}))}},3111:function(e,n,a){var i=a(1702),t=a(4488),r=a(1340),u=a(1361),d=i("".replace),l="["+u+"]",c=RegExp("^"+l+l+"*"),o=RegExp(l+l+"*$"),s=function(e){return function(n){var a=r(t(n));return 1&e&&(a=d(a,c,"")),2&e&&(a=d(a,o,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},1361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},9600:function(e,n,a){"use strict";var i=a(2109),t=a(1702),r=a(8361),u=a(5656),d=a(9341),l=t([].join),c=r!=Object,o=d("join",",");i({target:"Array",proto:!0,forced:c||!o},{join:function(e){return l(u(this),void 0===e?",":e)}})},3210:function(e,n,a){"use strict";var i=a(2109),t=a(3111).trim,r=a(6091);i({target:"String",proto:!0,forced:r("trim")},{trim:function(){return t(this)}})},7876:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CharacterMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"features"}},type:{kind:"NamedType",name:{kind:"Name",value:"jsonb"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxHp"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"currentHp"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"update_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pk_columns"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}]}},{kind:"Argument",name:{kind:"Name",value:"_set"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"ObjectField",name:{kind:"Name",value:"features"},value:{kind:"Variable",name:{kind:"Name",value:"features"}}},{kind:"ObjectField",name:{kind:"Name",value:"max_hp"},value:{kind:"Variable",name:{kind:"Name",value:"maxHp"}}},{kind:"ObjectField",name:{kind:"Name",value:"current_hp"},value:{kind:"Variable",name:{kind:"Name",value:"currentHp"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"features"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"maxHp"},name:{kind:"Name",value:"max_hp"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"currentHp"},name:{kind:"Name",value:"current_hp"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:333}};n.loc.source={body:"mutation CharacterMutation($characterId: uuid!, $name: String, $features: jsonb, $maxHp: Int, $currentHp: Int) {\n  update_characters_by_pk(pk_columns: {id: $characterId}, _set: {name: $name, features: $features, max_hp: $maxHp, current_hp: $currentHp}) {\n    id\n    name\n    features\n    maxHp: max_hp\n    currentHp: current_hp\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){a(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){a(e,n)})),e.definitions&&e.definitions.forEach((function(e){a(e,n)}))}var i={};function t(e,n){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==n)return i}}function r(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,u=new Set,d=new Set;r.forEach((function(e){d.add(e)}));while(d.size>0){var l=d;d=new Set,l.forEach((function(e){if(!u.has(e)){u.add(e);var n=i[e]||new Set;n.forEach((function(e){d.add(e)}))}}))}return u.forEach((function(n){var i=t(e,n);i&&a.definitions.push(i)})),a}(function(){n.definitions.forEach((function(e){if(e.name){var n=new Set;a(e,n),i[e.name.value]=n}}))})(),e.exports=n,e.exports.CharacterMutation=r(n,"CharacterMutation")},5245:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CharacterQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"character"},name:{kind:"Name",value:"characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"features"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"maxHp"},name:{kind:"Name",value:"max_hp"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"currentHp"},name:{kind:"Name",value:"current_hp"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"picture"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:185}};n.loc.source={body:"query CharacterQuery($characterId: uuid!) {\n  character: characters_by_pk(id: $characterId) {\n    id\n    name\n    features\n    maxHp: max_hp\n    currentHp: current_hp\n    picture\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){a(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){a(e,n)})),e.definitions&&e.definitions.forEach((function(e){a(e,n)}))}var i={};function t(e,n){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==n)return i}}function r(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,u=new Set,d=new Set;r.forEach((function(e){d.add(e)}));while(d.size>0){var l=d;d=new Set,l.forEach((function(e){if(!u.has(e)){u.add(e);var n=i[e]||new Set;n.forEach((function(e){d.add(e)}))}}))}return u.forEach((function(n){var i=t(e,n);i&&a.definitions.push(i)})),a}(function(){n.definitions.forEach((function(e){if(e.name){var n=new Set;a(e,n),i[e.name.value]=n}}))})(),e.exports=n,e.exports.CharacterQuery=r(n,"CharacterQuery")},5131:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CharacterPictureMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pictureUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"update_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"pk_columns"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}]}},{kind:"Argument",name:{kind:"Name",value:"_set"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"picture"},value:{kind:"Variable",name:{kind:"Name",value:"pictureUrl"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"picture"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:193}};n.loc.source={body:"mutation CharacterPictureMutation($characterId: uuid!, $pictureUrl: String!) {\n  update_characters_by_pk(pk_columns: {id: $characterId}, _set: {picture: $pictureUrl}) {\n    id\n    picture\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){a(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){a(e,n)})),e.definitions&&e.definitions.forEach((function(e){a(e,n)}))}var i={};function t(e,n){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==n)return i}}function r(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,u=new Set,d=new Set;r.forEach((function(e){d.add(e)}));while(d.size>0){var l=d;d=new Set,l.forEach((function(e){if(!u.has(e)){u.add(e);var n=i[e]||new Set;n.forEach((function(e){d.add(e)}))}}))}return u.forEach((function(n){var i=t(e,n);i&&a.definitions.push(i)})),a}(function(){n.definitions.forEach((function(e){if(e.name){var n=new Set;a(e,n),i[e.name.value]=n}}))})(),e.exports=n,e.exports.CharacterPictureMutation=r(n,"CharacterPictureMutation")},4714:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MyMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"characterId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"uuid"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"deleteCharacter"},name:{kind:"Name",value:"delete_characters_by_pk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"characterId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"gameId"},name:{kind:"Name",value:"game_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:139}};n.loc.source={body:"mutation MyMutation($characterId: uuid!) {\n  deleteCharacter: delete_characters_by_pk(id: $characterId) {\n    gameId: game_id,\n    id\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function a(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){a(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){a(e,n)})),e.definitions&&e.definitions.forEach((function(e){a(e,n)}))}var i={};function t(e,n){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==n)return i}}function r(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,u=new Set,d=new Set;r.forEach((function(e){d.add(e)}));while(d.size>0){var l=d;d=new Set,l.forEach((function(e){if(!u.has(e)){u.add(e);var n=i[e]||new Set;n.forEach((function(e){d.add(e)}))}}))}return u.forEach((function(n){var i=t(e,n);i&&a.definitions.push(i)})),a}(function(){n.definitions.forEach((function(e){if(e.name){var n=new Set;a(e,n),i[e.name.value]=n}}))})(),e.exports=n,e.exports.MyMutation=r(n,"MyMutation")}}]);
//# sourceMappingURL=characters-legacy.59104768.js.map